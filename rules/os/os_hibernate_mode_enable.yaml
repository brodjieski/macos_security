id: os_hibernate_mode_enable
title: Enable Hibernate Mode
discussion: $OS_VALUE
check: "error_count=0\nif /usr/sbin/ioreg -rd1 -c IOPlatformExpertDevice 2>&1 | /usr/bin/grep -q \"MacBook\"; then\n  hibernateMode=$(/usr/bin/pmset -b -g | /usr/bin/grep hibernatemode 2>&1 | /usr/bin/awk '{print $2}')\n  if [[ \"$(/usr/sbin/sysctl -n machdep.cpu.brand_string)\" =~ \"Intel\" ]]; then\n      hibernateStandbyLowValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelaylow 2>&1 | /usr/bin/awk '{print $2}')\n      hibernateStandbyHighValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelayhigh 2>&1 | /usr/bin/awk '{print $2}')\n      hibernateStandbyThreshValue=$(/usr/bin/pmset -g | /usr/bin/grep highstandbythreshold 2>&1 | /usr/bin/awk '{print $2}')\n      \n      if [[ \"$hibernateStandbyLowValue\" == \"\" ]] || [[ \"$hibernateStandbyLowValue\" -gt 600 ]]; then\n          ((error_count++))\n      fi\n      if [[ \"$hibernateStandbyHighValue\" == \"\" ]] || [[ \"$hibernateStandbyHighValue\" -gt 600 ]]; then\n          ((error_count++))\n      fi\n      if [[ \"$hibernateStandbyThreshValue\" == \"\" ]] || [[ \"$hibernateStandbyThreshValue\" -lt 90 ]]; then\n          ((error_count++))\n      fi\n  else\n      if [[ \"$(/usr/bin/pmset -g | /usr/bin/grep standbydelay 2>&1 | /usr/bin/awk '{print $2}')\" -gt 900 ]]; then\n          ((error_count++))\n      fi\n  fi\n  if [[ \"$hibernateMode\" == \"\" ]] || [[ \"$hibernateMode\" != 25 ]]; then\n    ((error_count++))\n  fi\nfi\necho \"$error_count\"\n"
result: 0
fix: |
  [source,bash]
  ----
  /usr/bin/pmset -a hibernatemode 25
  if [[ "$(/usr/sbin/sysctl -n machdep.cpu.brand_string)" =~ "Intel" ]]; then
    /usr/bin/pmset -a standbydelayhigh 600
    /usr/bin/pmset -a standbydelaylow 600
    /usr/bin/pmset -a highstandbythreshold 90
  else
    /usr/bin/pmset -a standbydelay 900
  fi
  ----
references:
  disa:
    srg:
      - $OS_VALUE
    disa_stig:
      - $OS_VALUE
    cci:
      - None
    sfr:
      - $OS_VALUE
  nist:
    cce:
      - $OS_VALUE
    800-53r5:
      - N/A
    800-53r4:
      - N/A
    800-171r2:
      - N/A
  cis:
    benchmark:
      - $OS_VALUE
    controls v8:
      - $OS_VALUE
tags:
  - cis_lvl2
  - cisv8
mobileconfig: false
mobileconfig_info: null
os_specifics:
  macOS:
    '11.0':
      references:
        disa:
          disa_stig:
            - N/A
          srg:
            - N/A
          sfr:
            - N/A
        nist:
          cce:
            - CCE-85505-6
        cis:
          benchmark:
            - 2.8.3 (level 2)
          controls v8:
            - 4.1
      discussion: "Hibernate mode _MUST_ be enabled. \n\nNOTE: Hibernate mode will disable instate wake on Apple Silicon laptops.\n"
    '12.0':
      references:
        disa:
          disa_stig:
            - N/A
          srg:
            - N/A
          sfr:
            - N/A
        nist:
          cce:
            - CCE-91106-5
        cis:
          benchmark:
            - 2.8.3 (level 2)
          controls v8:
            - 4.1
      discussion: "Hibernate mode _MUST_ be enabled. \n\nNOTE: Hibernate mode will disable instate wake on Apple Silicon laptops.\n"
    '13.0':
      references:
        disa:
          disa_stig:
            - N/A
          srg:
            - N/A
          sfr:
            - N/A
        nist:
          cce:
            - CCE-91799-7
        cis:
          benchmark:
            - 2.9.3 (level 2)
          controls v8:
            - 4.1
      discussion: "Hibernate mode _MUST_ be enabled. \n\nNOTE: Hibernate mode will disable instant wake on Apple Silicon laptops.\n"
