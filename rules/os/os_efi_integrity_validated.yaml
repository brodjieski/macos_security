id: os_efi_integrity_validated
title: Ensure Extensible Firmware Interface Version is Valid
discussion: |
  The macOS Extensible Firmware Interface (EFI) _MUST_ be checked to ensure it is a known good version from Apple.
check: |
  if /usr/sbin/ioreg -w 0 -c AppleSEPManager | /usr/bin/grep -q AppleSEPManager; then echo "1"; else /usr/libexec/firmwarecheckers/eficheck/eficheck --integrity-check | /usr/bin/grep -c "No changes detected"; fi
result: 1
fix: |
  Install a known good version of macOS.
references:
  disa:
    disa_stig:
      - $OS_VALUE
    cci:
      - None
    srg:
      - $OS_VALUE
    sfr:
      - $OS_VALUE
  nist:
    cce:
      - $OS_VALUE
    800-53r5:
      - N/A
    800-53r4:
      - N/A
    800-171r2:
      - N/A
  cis:
    benchmark:
      - $OS_VALUE
    controls v8:
      - $OS_VALUE
tags:
  - cis_lvl1
  - cis_lvl2
  - cisv8
  - i386
mobileconfig: false
mobileconfig_info: null
os_specifics:
  macOS:
    '11.0':
      references:
        disa:
          disa_stig:
            - None
          srg:
            - None
          sfr:
            - N/A
        nist:
          cce:
            - CCE-85502-3
        cis:
          benchmark:
            - 2.9 (level 1)
          controls v8:
            - 2.2
    '12.0':
      references:
        disa:
          disa_stig:
            - None
          srg:
            - None
          sfr:
            - N/A
        nist:
          cce:
            - CCE-91102-4
        cis:
          benchmark:
            - 2.9 (level 1)
          controls v8:
            - 2.2
    '13.0':
      references:
        disa:
          disa_stig:
            - None
          srg:
            - None
          sfr:
            - N/A
        nist:
          cce:
            - CCE-91781-5
        cis:
          benchmark:
            - 5.9 (level 1)
          controls v8:
            - 2.2
