id: os_anti_virus_installed
title: Must Use an Approved Antivirus Program
discussion: |
  An approved antivirus product _MUST_ be installed and configured to run.

  Malicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.'
check: $OS_VALUE
result: 1
fix: $OS_VALUE
references:
  disa:
    cci:
      - CCI-000366
    srg:
      - $OS_VALUE
    disa_stig:
      - $OS_VALUE
    sfr:
      - $OS_VALUE
  nist:
    cce:
      - $OS_VALUE
    800-53r5:
      - N/A
    800-53r4:
      - SI-2
tags:
  - none
  - stig
  - manual
severity: high
mobileconfig: false
mobileconfig_info: null
os_specifics:
  macOS:
    '11.0':
      references:
        disa:
          disa_stig:
            - APPL-11-002070
          srg:
            - SRG-OS-000480-GPOS-00227
          sfr:
            - N/A
        nist:
          cce:
            - CCE-85501-5
      check: |
        /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.mrt" => false'
      fix: |
        [source,bash]
        ----
        /bin/launchctl enable system/com.apple.mrt
        ----
    '10.15':
      references:
        disa:
          disa_stig:
            - AOSX-15-002070
          srg:
            - SRG-OS-000480-GPOS-00227
          sfr:
            - N/A
        nist:
          cce:
            - CCE-84894-5
      check: "Ask the System Administrator (SA) or Information System Security Officer (ISSO) if an approved antivirus solution is loaded on the system. The antivirus solution may be bundled with an approved host-based security solution. \nIf there is no local antivirus solution installed on the system, this is a finding.\n"
      fix: |
        Install an approved antivirus solution onto the system.
    '12.0':
      references:
        disa:
          disa_stig:
            - APPL-12-002070
          srg:
            - SRG-OS-000480-GPOS-00227
          sfr:
            - N/A
        nist:
          cce:
            - CCE-90900-2
      check: |
        /bin/launchctl list | /usr/bin/grep -cE "(com.apple.XprotectFramework.PluginService$|com.apple.XProtect.daemon.scan$)"
      fix: |
        [source,bash]
        ----
        /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XProtect.daemon.scan.plist
        /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XprotectFramework.PluginService.plist
        ----
    '13.0':
      references:
        disa:
          disa_stig:
            - N/A
          srg:
            - N/A
          sfr:
            - N/A
        nist:
          cce:
            - CCE-91756-7
      check: |
        /bin/launchctl list | /usr/bin/grep -cE "(com.apple.XprotectFramework.PluginService$|com.apple.XProtect.daemon.scan$)"
      fix: |
        [source,bash]
        ----
        /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XProtect.daemon.scan.plist
        /bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XprotectFramework.PluginService.plist
        ----
