id: os_mdm_require
title: Enforce Enrollment in Mobile Device Management
discussion: |
  You _MUST_ enroll your Mac in a Mobile Device Management (MDM) software.

  User Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager (ASM) is required to manage certain security settings. Currently these include:

  * Allowed Kernel Extensions
  * Allowed Approved System Extensions
  * Privacy Preferences Policy Control Payload
  * ExtensibleSingleSignOn
  * FDEFileVault

  In macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were previously locked behind ABM:

  * Activation Lock Bypass
  * Access to Bootstrap Tokens
  * Scheduling Software Updates
  * Query list and delete local users
check: |
  /usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep -c "Yes (User Approved)"
result: 1
fix: |
  Ensure that system is enrolled via UAMDM.
references:
  disa:
    disa_stig:
      - $OS_VALUE
    srg:
      - $OS_VALUE
    cci:
      - N/A
    sfr:
      - $OS_VALUE
  nist:
    cce:
      - $OS_VALUE
    800-53r5:
      - CM-2
      - CM-6
    800-53r4:
      - CM-2
      - CM-6
    800-171r2:
      - 3.4.1
      - 3.4.2
  cis:
    benchmark:
      - $OS_VALUE
    controls v8:
      - $OS_VALUE
tags:
  - 800-53r5_low
  - 800-53r5_moderate
  - 800-53r5_high
  - 800-53r4_low
  - 800-53r4_moderate
  - 800-53r4_high
  - 800-171
  - cisv8
  - cnssi-1253
mobileconfig: false
mobileconfig_info: null
os_specifics:
  macOS:
    '11.0':
      references:
        cce:
          - CCE-85338-2
        disa_stig:
          - N/A
        srg:
          - N/A
        sfr:
          - N/A
        cis:
          benchmark:
            - N/A
          controls v8:
            - 4.1
            - 5.1
    '10.15':
      references:
        cce:
          - CCE-84803-6
        disa_stig:
          - N/A
        srg:
          - N/A
        sfr:
          - N/A
        cis:
          benchmark:
            - N/A
          controls v8:
            - 4.1
            - 5.1
    '12.0':
      references:
        cce:
          - CCE-90950-7
        disa_stig:
          - N/A
        srg:
          - N/A
        sfr:
          - N/A
        cis:
          benchmark:
            - N/A
          controls v8:
            - 4.1
            - 5.1
    '13.0':
      references:
        cce:
          - CCE-91820-1
        disa_stig:
          - N/A
        srg:
          - N/A
        sfr:
          - N/A
        cis:
          benchmark:
            - N/A
          controls v8:
            - 4.1
            - 5.1
